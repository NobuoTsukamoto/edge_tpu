# Image Segmentation

Based on the TensorFlow tutorial, it is an image segmentation model that runs on Edge TPU.<br>
Only the CPU of Raspberry pi 4 can execute it ([integer quantization model](https://www.tensorflow.org/lite/performance/post_training_integer_quant)).

![Image](g3doc/segmentation.gif)

# Models
Use the modified U-Net. See the [TensorFlow tutorial](https://github.com/tensorflow/docs/blob/master/site/en/tutorials/images/segmentation.ipynb) for details.<br>
Following the tutorial, the model generated by post training quantization after training Oxford-IIIT Pet Dataset is as follows.<br>
Train a model with [this notebook](segmentation_post_training_quant.ipynb).
- [Integer quantization model (model.tflite)](model).
- [Edge TPU model (model_edgetpu.tflite)](model)

# Note
The license of segmentation_post_training_quant.ipynb follows the original [tensorflow/doc](https://github.com/tensorflow/docs/blob/master/LICENSE) license.

# Usage
- image_segmentation_tflite_capture_opencv.py:<br>
``` 
    # move to edge_tpu/segmentation

    # CPU only (Raspberry Pi 4 + PiCamera)
    $ python3 image_segmentation_tflite_capture_opencv.py --model model/model.tflite --thread=2

    # Edge TPU (Raspberry Pi 4 + PiCamera)
    $ python3 image_segmentation_tflite_capture_opencv.py --model model/model_edgetpu.tflite
```